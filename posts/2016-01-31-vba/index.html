<!doctype html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Jongwony</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="/blog/static/css/style.css">
    <link rel="stylesheet" href="/blog/static/css/custom.css">
    <link rel="stylesheet" href="/blog/static/css/vim.css">
</head>

<body class="box">

<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="/blog/">Jongwony</a>

    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>


    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active"><a class="nav-link" href="/blog/about.html">About</a></li>

            <li class="nav-item"><a class="nav-link" href="https://github.com/lastone9182/blog">Source</a></li>
        </ul>
    </div>
</nav>

<div class="container">

  <div class="content" role="main">
    

<h1>VBA</h1>

<small class="date">2016-01-31 00:00:00</small>

    <br>


    <a id="tag" href="/search/visual basic">
      <img src="//img.shields.io/badge/-Visual basic-orange.svg" alt="visual basic" />
    </a>

    <a id="tag" href="/search/customize">
      <img src="//img.shields.io/badge/-Customize-orange.svg" alt="customize" />
    </a>


    <hr>

<p>VBA란 Visual Basic Application의 약자로, 주로 MS OFFICE의 매크로로서 사용될 수 있습니다.</p>

<p>주로 엑셀에 사용되지만 여기서는 워드작업 중 일부만 다룹니다.</p>

<p>워드 작업을 할 때 이미지를 많이 사용 할 경우 일괄적으로 처리하고 싶은 부분이 있을 것입니다.</p>

<p>크기 맞추기와 위치 정렬 등...</p>

<p><a href="https://github.com/lastone9182/VBA-content">라이브러리</a>를 참조해서 간단히 만들어 보았습니다.</p>

<div class="codehilite"><pre><span></span><span class="k">Sub</span> <span class="nf">CustomImgAll</span><span class="p">()</span>
  <span class="k">Dim</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
  <span class="k">For</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span> <span class="k">To</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">.</span><span class="n">Count</span>
    <span class="k">With</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="p">.</span><span class="n">Width</span> <span class="o">=</span> <span class="n">CentimetersToPoints</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
      <span class="c">&#39;.Height = CentimetersToPoints(10)</span>
      <span class="p">.</span><span class="n">Range</span><span class="p">.</span><span class="n">ParagraphFormat</span><span class="p">.</span><span class="n">Alignment</span> <span class="o">=</span> <span class="n">wdAlignParagraphCenter</span>
    <span class="k">End</span> <span class="k">With</span>
  <span class="k">Next</span> <span class="n">i</span>
<span class="k">End</span> <span class="k">Sub</span>
</pre></div>

<p>위 코드는 현재 열려있는 모든 문서(ActiveDocument)에서</p>

<p>인라인으로 삽입된 개체(InlineShapes)의 너비(Width) 또는 높이(Height)를 변화하고
('기호는 VB의 주석입니다.)</p>

<p>가운데로 정렬(wdAlignParagraphCenter) 시켜줍니다.</p>

<p>워드로 사진을 드래그 등으로 집어 넣을 때 글자처럼 취급(Inline)상태가 자동으로 되더군요. 이런 개체만 인식해서 For로 순회하여 모두 바꿔줍니다.</p>

<p>조건문, MsgBox 등을 넣어 복잡하고 강력한 매크로로도 만들 수 있지만</p>

<p>문서작업을 위한 매크로는 간단한 것들을 여러개 만드는 것이 좋다고 생각합니다.</p>

<p>Reference : <a href="https://msdn.microsoft.com/en-us/library/office/gg264383.aspx">MSDN</a></p>


  </div>

</div><!-- end container -->

<footer>
    <div class="copyright">
        <small>Copyright &copy; 2017 Jongwony</small>
    </div>
</footer>

<script src="/blog/static/js/script.js"></script>
<script src="/blog/static/js/custom.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>

</body>
</html>